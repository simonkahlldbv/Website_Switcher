<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Modellvergleich</title>
<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

<style>
    body {
        margin: 0;
        overflow: hidden;
        background: #fff;
        font-family: Arial;
    }

    /* Seitenlayout */
    #sidebar {
        position: fixed;
        left: 0;
        top: 0;
        bottom: 0;
        width: 160px;
        background: #f2f2f2;
        padding: 20px;
        overflow-y: auto;
        z-index: 10;
    }

    #main-view {
        position: fixed;
        left: 160px;
        right: 0;
        top: 0;
        bottom: 0;
        background: white;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    #year-buttons button {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        font-size: 16px;
        cursor: pointer;
    }

    #compare-trigger {
        margin-top: 30px;
        width: 100%;
        padding: 10px;
        background: #d33;
        color: white;
        border: none;
        cursor: pointer;
        font-size: 16px;
    }

    /* Vergleichsmodus */
    #compare-mode {
        display: none;
        position: fixed;
        inset: 0;
        background: white;
        z-index: 999;
    }

    #back-button {
        position: absolute;
        top: 20px;
        left: 20px;
        padding: 10px 20px;
        background: black;
        color: white;
        border: none;
        font-size: 16px;
        cursor: pointer;
        z-index: 1000;
    }

    /* Modell-Container */
    #compare-container {
        position: absolute;
        inset: 0;
        overflow: hidden;
    }

    #modelA, #modelB {
        position: absolute;
        top: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
    }

    #modelA { clip-path: inset(0 50% 0 0); }
    #modelB { clip-path: inset(0 0 0 50%); }

    /* Slider */
    #slider {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 4px;
        background: red;
        left: 50%;
        cursor: ew-resize;
        z-index: 1000;
    }

    /* Sync-Hover (kein Cursor-Symbol von model-viewer!) */
    model-viewer::part(default-controls) {
        display: none !important;
    }
</style>
</head>
<body>

<!-- Seitenleiste -->
<div id="sidebar">
    <div id="year-buttons"></div>
    <button id="compare-trigger">Vergleichen</button>
</div>

<!-- Hauptmodellanzeige -->
<div id="main-view">
    <model-viewer id="main-model" camera-controls touch-action="none" disable-zoom></model-viewer>
</div>

<!-- Vergleichsmodus -->
<div id="compare-mode">
    <button id="back-button">← Zurück</button>

    <div id="compare-container">
        <model-viewer id="modelA" camera-controls touch-action="none" disable-zoom></model-viewer>
        <model-viewer id="modelB" camera-controls touch-action="none" disable-zoom></model-viewer>
    </div>

    <div id="slider"></div>
</div>

<script>
/* ------------------------------
   MODELLE DEFINIEREN
------------------------------ */
const models = {
    "2003": "facelift_orange_2003.glb",
    "2006": "facelift_orange_2006.glb",
    "2009": "facelift_orange_2009.glb",
    "2013": "facelift_orange_2013.glb",
    "2016": "facelift_orange_2016.glb",
    "2020": "facelift_orange_2020.glb"
};

/* ------------------------------
   JAHRE ALS BUTTONS LADEN
------------------------------ */
const yearButtons = document.getElementById("year-buttons");
const mainModel = document.getElementById("main-model");

for (const year in models) {
    const btn = document.createElement("button");
    btn.innerText = year;
    btn.onclick = () => {
        mainModel.src = models[year];
    };
    yearButtons.appendChild(btn);
}

/* Erster Load */
mainModel.src = models["2003"];

/* ------------------------------
   VERGLEICHSMODUS
------------------------------ */
const compareMode = document.getElementById("compare-mode");
const backButton = document.getElementById("back-button");
const slider = document.getElementById("slider");

const modelA = document.getElementById("modelA");
const modelB = document.getElementById("modelB");

/* Vergleich starten */
document.getElementById("compare-trigger").onclick = () => {
    compareMode.style.display = "block";

    modelA.src = models["2003"];
    modelB.src = models["2020"];
};

/* Vergleich beenden */
backButton.onclick = () => {
    compareMode.style.display = "none";
};

/* ------------------------------
   SLIDER LOGIK
------------------------------ */
let sliding = false;

slider.addEventListener("mousedown", () => sliding = true);
window.addEventListener("mouseup", () => sliding = false);
window.addEventListener("mousemove", e => {
    if (!sliding) return;

    let x = e.clientX / window.innerWidth;

    x = Math.min(0.95, Math.max(0.05, x));

    slider.style.left = (x * 100) + "%";

    modelA.style.clipPath = `inset(0 ${(1 - x) * 100}% 0 0)`;
    modelB.style.clipPath = `inset(0 0 0 ${x * 100}%)`;
});

/* ------------------------------
   SYNCHRONISIERTE STEUERUNG
------------------------------ */
function sync(a, b) {
    a.addEventListener("camera-change", () => {
        b.cameraOrbit = a.cameraOrbit;
        b.cameraTarget = a.cameraTarget;
        b.fieldOfView = a.fieldOfView;
    });
}

sync(modelA, modelB);
sync(modelB, modelA);

</script>
</body>
</html>
